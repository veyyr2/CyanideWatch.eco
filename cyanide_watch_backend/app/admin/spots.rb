# app/admin/spots.rb

# Эта строка регистрирует вашу модель Spot в ActiveAdmin.
# ActiveAdmin автоматически создаст маршруты, контроллеры и представления
# для управления данными этой модели.
ActiveAdmin.register Spot do

    # --- Раздел Strong Parameters (обязателен для безопасности!) ---
    # Здесь вы перечисляете через запятую символами (символ `:` перед именем),
    # КАКИЕ поля модели Spot разрешено изменять или создавать через формы админки.
    # Это защищает от нежелательных изменений других полей.
    # Убедитесь, что здесь перечислены все поля вашей модели Spot, которые
    # вы хотите видеть в формах редактирования/создания.
    permit_params :location, :lat, :lng, :measurement_type, :measurement_value, :date, :description, :news_link
    # Если у вас есть другие поля в модели Spot, добавьте их сюда.
  
    # --- Раздел настройки страницы списка записей (Index Page) ---
    # Этот блок позволяет настроить, какие колонки будут отображаться
    # на странице со списком всех записей Spot (/admin/spots).
    index do
      # Чекбоксы для выбора нескольких записей (для массовых действий)
      selectable_column
      # Колонка с уникальным ID записи. ID является ссылкой на страницу просмотра детали записи.
      id_column
      # Отображение конкретных атрибутов модели как колонок в таблице
      column :location
      column :measurement_type
      column :measurement_value
      column :date
      # Пример настройки отображения колонки (например, сделать ссылку кликабельной)
      column :news_link do |spot|
         if spot.news_link.present?
           # Создаем кликабельную ссылку, открывающуюся в новой вкладке
           link_to "Ссылка на новость", spot.news_link, target: "_blank"
         else
           # Если ссылки нет, выводим текст
           "Нет ссылки"
         end
       end
      # Если у вас есть другие поля, которые вы хотите видеть в списке, добавьте их здесь:
      # column :имя_поля_1
      # column :имя_поля_2
      # ...
  
      # Колонки с основными действиями для каждой записи (View, Edit, Delete)
      actions
    end
  
    # --- Раздел настройки фильтров (Sidebar Filters) ---
    # Этот блок добавляет в боковую панель страницы Index фильтры,
    # по которым можно искать записи.
    filter :location         # Фильтр по полю location
    filter :measurement_type # Фильтр по полю measurement_type
    filter :date             # Фильтр по полю date (обычно появляется календарь или выбор диапазона)
    filter :measurement_value # Фильтр по значению измерения
    # Добавьте фильтры для других полей, по которым вам нужен поиск:
    # filter :имя_поля_3
  
    # --- Раздел настройки формы создания/редактирования записей (Form Page) ---
    # Этот блок определяет, какие поля будут в форме, когда вы создаете новую запись Spot
    # или редактируете существующую.
    form do |f|
      # inputs создает логические секции или группы полей в форме
      f.inputs "Детали Точки Загрязнения" do
        # input создает отдельное поле формы для атрибута модели
        f.input :location
        f.input :lat
        f.input :lng
        # Вы можете указать тип контрола, например, :select для выпадающего списка
        f.input :measurement_type, as: :select, collection: ["water", "soil", "air"] # Пример с вашими типами из seeds.rb
        f.input :measurement_value
        # Для поля даты часто удобно использовать datepicker
        # f.input :date, as: :datepicker # Для этого может потребоваться дополнительная настройка или гем (например, activeadmin-addons)
        f.input :date # Стандартный ввод даты
        f.input :description
        f.input :news_link
        # Добавьте здесь другие поля вашей модели, которые должны быть в форме:
        # f.input :другое_поле
  
        # Если у вашей модели Spot есть связи с другими моделями (например, has_one :location),
        # вы можете добавить поле для выбора связанной записи:
        # f.input :location # ActiveAdmin попытается отобразить выпадающий список связанных локаций
      end
      # actions создает стандартные кнопки формы ("Создать Spot", "Обновить Spot", "Отмена")
      f.actions
    end
  
    # --- Раздел настройки страницы просмотра одной записи (Show Page) ---
    # Этот блок определяет, как будет выглядеть страница с деталями одной конкретной записи Spot.
    show do
      attributes_table do
        row :location
        row :lat
        row :lng
        row :measurement_type
        row :measurement_value
        row :date
        row :description
        row :news_link do |spot|
          if spot.news_link.present?
            link_to "Ссылка на новость", spot.news_link, target: "_blank"
          else
            "Нет ссылки"
          end
        end
        # Добавьте здесь другие поля, которые хотите видеть на странице просмотра
        # row :другое_поле
      end
      # Можно добавить другие секции, например, связанные записи
      # panel "Recent Comments" do
      #   # ...
      # end
    end
  
  end